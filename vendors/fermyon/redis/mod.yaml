validate:
  allow_wasi: true

  imports:
    include:
    - name: fd_write
      namespace: wasi_snapshot_preview1
      params: [I32, I32, I32, I32]
      results: [I32]
    - name: environ_get
      namespace: wasi_snapshot_preview1
      params: [I32, I32]
      results: [I32]
    - name: environ_sizes_get
      namespace: wasi_snapshot_preview1
      params: [I32, I32]
      results: [I32]
    - name: proc_exit
      namespace: wasi_snapshot_preview1
      params: [I32]
      results: []
    namespace:
      include:
      - wasi_snapshot_preview1
  
  exports:
    max: 3
    include:
    - name: handle-redis-message
      params: [I32, I32]
      results: [I32]
    - name: canonical_abi_realloc
      params: [I32, I32, I32, I32]
      results: [I32]
    - name: canonical_abi_free
      params: [I32, I32, I32]
      results: []

  complexity: 
    max_risk: medium
   
